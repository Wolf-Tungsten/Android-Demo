# Android活动

## 活动的基本用法

### 手动创建活动、布局、在活动中加载布局

### 使用Toast

### 使用Menu

首先在res目录下新建一个叫做main的menu文件，在main.xml文件中添加 `<item>` 标签，每个item代表菜单的一项。

```xml
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:android="http://schemas.android.com/apk/res/android">
    <item
        android:id="@+id/add_item"
        android:title="Add" />
    <item
        android:id="@+id/remove_item"
        android:title="Remove"/>
</menu>
```

`android:id` 给每个菜单项唯一的标识符， `android:title` 给菜单项指定显示的名称。

接着回到FirstActivity中重写 `onCreateOptionsMenu()` 方法，AS中重写方法可以按control+O键来快速实现，编写如下代码：

```java
@Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }
```

通过 `getMenuInflater()` 得到一个MenuInflater对象，再调用 `inflate()` 。方法返回true则菜单可以被显示出来，否则菜单不显示。

为了让菜单项目点击后会有反应，应该重写 `onOptionsItemSelected()` 方法：

```Java
@Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch(item.getItemId()) {
            case R.id.add_item:
                Toast.makeText(this, "You clicked Add", 										Toast.LENGTH_SHORT).show();
                break;
            case R.id.remove_item:
                Toast.makeText(this, "You clicked 											remove",Toast.LENGTH_LONG).show();
                break;
            default:

        }
        return true;
    }
```

### 销毁一个活动

在需要的地方调用finish()方法

## 使用Intent在活动之间穿梭

### 显式Intent

先构造出一个Intent对象，在调用类的 `startActivity()` 方法即可实现启动下一个活动。

```java
Intent intent = new Intent(FirstActivity.this,         									   SecondActivity.class);
startActivity(intent);
```

### 隐式Intent

可以通过设定活动的action和category，然后依据这些信息来启动活动。

首先修改AndroidManifest.xml中对于活动的设置

```xml
<activity android:name=".SecondActivity">
            <intent-filter>
                <action android:name="riku"/>
                <category 						        android:name="android.intent.category.DEFAULT"/>
            </intent-filter>
</activity>
```

然后修改Intent

```Java
 Intent intent = new Intent("riku");
 startActivity(intent);
```

由于 `android.intent.category.DEFAULT`是默认的category名称，所以此时不用指定category也能正确启动活动。只是传入了action中设定的字符串。

如果category的名称不是默认的，就需要指定category了

```xml
<activity android:name=".SecondActivity">
     <intent-filter>
          <action android:name="riku"/>
          <category android:name="android.intent.category.DEFAULT"/>
          <category android:name="miaomiaomiao"/>
     </intent-filter>
</activity>
```

添加了一个category，使用Intent的 `addCategory()` 方法

```java
Intent intent = new Intent("riku");
intent.addCategory("miaomiaomiao");
startActivity(intent);
```

就启动了对应的活动。

### More about 隐式Intent

使用隐式Intent还可以启动别的APP的活动，先来两个栗子：

- 访问浏览器

```java
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setData(Uri.parse("https://wolf.myseu.cn"));
startActivity(intent);
```

`setData()` 方法接受一个Uri对象，可以通过给 `<intent-filter>` 标签设置 `<data>` 标签来确定活动能响应什么样的数据

| 配置内容             | 含义                          |
| ---------------- | --------------------------- |
| android:scheme   | 指定数据的协议，例如刚才的https          |
| android:host     | 指定主机名的部分，例如刚才的wolf.myseu.cn |
| android:port     | 端口号                         |
| android:path     | 位于主机名和端口号后面的部分              |
| android:mimeType | 用于指定可以处理的数据                 |

只有在data内容完全匹配时才能启动活动，但是一般的情况下不会指定过多的data，例如启动浏览器只要明确协议名称是https就可以了。

- 调起拨号应用

```Java
Intent intent = new Intent(Intent.ACTION_DIAL);
intent.setData(Uri.parse("tel:10010"));
startActivity(intent);
```

然后自定义一个活动来响应刚才浏览器的请求

```Xml
<activity android:name=".ThirdActivity">
  <intent-filter>
    <action android:name="android.intent.action.VIEW"/>
    <category android:name="android.intent.category.DEFAULT"/>
    <data android:scheme="http"/>
  </intent-filter>
</activity>
```

### 向下一个活动传递数据

基本思路是：把要传递的数据放在intent里，再下一个活动中读取intent中的数据。数据采用键值对的方式进行传递，例如，要从FirstActivity中向SecondActivity中传递数据（此处是一个字符串），然后在SecondActivity中用Toast显示出来

```java
String data = "Hello Activity！";
Intent intent =new Intent(FirstActivity.this,
SecondActivity.class);
intent.putExtra("data", data);
startActivity(intent);
```

在SecondActivity中读取时要使用对应数据类型的方法，这些方法包括 `getStringExtra()` `getBooleanExtra()` `getIntExtra()` 

```java
Intent intent = getIntent();
String data = intent.getStringExtra("data");
```

